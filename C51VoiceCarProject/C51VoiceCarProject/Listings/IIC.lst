C51 COMPILER V9.60.7.0   IIC                                                               03/21/2024 10:21:54 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE IIC
OBJECT MODULE PLACED IN .\Objects\IIC.obj
COMPILER INVOKED BY: D:\Keil C51\C51\BIN\C51.EXE IIC.c LARGE OMF2 OPTIMIZE(8,SPEED) BROWSE DEBUG PRINT(.\Listings\IIC.ls
                    -t) OBJECT(.\Objects\IIC.obj)

line level    source

   1          #include "IIC.h"
   2          
   3          /******************************************************************************/
   4          /* 函数名称  : IIC_Init                                                                   */
   5          /* 函数描述  : 初始化IIC协议，拉高时钟总线和数据总线                                                      */    
   6          /* 输入参数  : 无                                                             */
   7          /* 参数描述  : 无                                                                                     */
   8          /* 返回值    : 无                                                             */
   9          /******************************************************************************/
  10          void IIC_Init()
  11          {
  12   1              IIC_SCL = HIGH;
  13   1              _nop_();
  14   1              IIC_SDA = HIGH;
  15   1              _nop_();
  16   1      }
  17          
  18          /******************************************************************************/
  19          /* 函数名称  : IIC_Start                                                                  */
  20          /* 函数描述  : IIC协议，开始信号，数据总线由高到低                                                        */    
  21          /* 输入参数  : 无                                                             */
  22          /* 参数描述  : 无                                                                                     */
  23          /* 返回值    : 无                                                             */
  24          /******************************************************************************/
  25          void IIC_Start()
  26          {
  27   1              IIC_SCL = HIGH;
  28   1              IIC_SDA = HIGH;
  29   1              _nop_();
  30   1              IIC_SDA = LOW;
  31   1              _nop_();
  32   1              IIC_SCL = LOW;
  33   1      }
  34          
  35          /******************************************************************************/
  36          /* 函数名称  : IIC_Stop                                                                   */
  37          /* 函数描述  : IIC协议，结束信号，数据总线由低到高                                                        */    
  38          /* 输入参数  : 无                                                             */
  39          /* 参数描述  : 无                                                                                     */
  40          /* 返回值    : 无                                                             */
  41          /******************************************************************************/
  42          void IIC_Stop()
  43          {
  44   1              IIC_SCL = HIGH;
  45   1              IIC_SDA = LOW;
  46   1              _nop_();
  47   1              IIC_SDA = HIGH;
  48   1              _nop_();
  49   1              IIC_SCL = LOW;
  50   1      }
  51          
  52          /******************************************************************************/
  53          /* 函数名称  : IIC_Ack                                                                            */
  54          /* 函数描述  : IIC协议，应答信号，时钟总线拉高时，数据总线拉低，表示应答 0                */    
C51 COMPILER V9.60.7.0   IIC                                                               03/21/2024 10:21:54 PAGE 2   

  55          /* 输入参数  : 无                                                             */
  56          /* 参数描述  : 无                                                                                     */
  57          /* 返回值    : 无                                                             */
  58          /******************************************************************************/
  59          void IIC_Ack()
  60          {
  61   1              IIC_SCL = LOW;
  62   1              IIC_SDA = LOW;
  63   1              _nop_();
  64   1              IIC_SCL = HIGH;
  65   1              _nop_();
  66   1              IIC_SCL = LOW;
  67   1      }
  68          
  69          /******************************************************************************/
  70          /* 函数名称  : IIC_NAck                                                                   */
  71          /* 函数描述  : IIC协议，应答信号，时钟总线拉高时，数据总线拉高，表示非应答 1      */    
  72          /* 输入参数  : 无                                                             */
  73          /* 参数描述  : 无                                                                                     */
  74          /* 返回值    : 无                                                             */
  75          /******************************************************************************/
  76          void IIC_NAck()
  77          {
  78   1              IIC_SCL = LOW;
  79   1              IIC_SDA = HIGH;
  80   1              _nop_();
  81   1              IIC_SCL = HIGH;
  82   1              _nop_();
  83   1              IIC_SCL = LOW;
  84   1      }
  85          
  86          /******************************************************************************/
  87          /* 函数名称  : IIC_NAck                                                                   */
  88          /* 函数描述  : IIC协议，等待应答信号，从数据总线SDA中读取是否应答信号                     */    
  89          /* 输入参数  : 无                                                             */
  90          /* 参数描述  : 无                                                                                     */
  91          /* 返回值    : 是否应答信号                                                    */
  92          /******************************************************************************/
  93          unsigned char IIC_Wait_Ack()
  94          {
  95   1              unsigned char flag;
  96   1              IIC_SCL = LOW;
  97   1              IIC_SDA = HIGH;
  98   1              _nop_();
  99   1              IIC_SCL = HIGH;
 100   1              _nop_();
 101   1              flag = IIC_SDA;
 102   1              _nop_();
 103   1              IIC_SCL = LOW;
 104   1              return flag;
 105   1      }
 106          
 107          /******************************************************************************/
 108          /* 函数名称  : IIC_Write_Data                                                             */
 109          /* 函数描述  : IIC协议，写数据，每次获取一位，由高到低获取                                        */    
 110          /* 输入参数  : dat                                                            */
 111          /* 参数描述  : 写入的数据                                                                     */
 112          /* 返回值    : 无                                                                          */
 113          /******************************************************************************/
 114          void IIC_Write_Data(unsigned char dat)
 115          {
 116   1              unsigned char i;
C51 COMPILER V9.60.7.0   IIC                                                               03/21/2024 10:21:54 PAGE 3   

 117   1              IIC_SCL = LOW;
 118   1              for(i=0;i<8;i++)
 119   1              {
 120   2                      IIC_SDA = dat & 0x80;
 121   2                      _nop_();
 122   2                      IIC_SCL = HIGH;
 123   2                      _nop_();
 124   2                      IIC_SCL = LOW;
 125   2                      _nop_();
 126   2                      dat <<= 1;
 127   2              }
 128   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     93    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
